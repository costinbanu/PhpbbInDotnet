function resizeImage(n,t,i){lazyInit(t,i);let u=$(n).parents("blockquote").length,o=maxWidth-u*quoteWidthBleed,s=maxHeight-u*quoteHeightBleed,f=n.naturalWidth,e=n.naturalHeight,r=Math.min(s/e,o/f);r<1?($(n).css({width:roundToNextEvenNumber(f*r)+"px",height:roundToNextEvenNumber(e*r)+"px"}),$(n).parent().is("a")||($(n).attr({onclick:"window.open(this.src);",title:clickToEnlarge}),$(n).css("cursor","pointer"))):$(n).css({width:"auto",height:"auto"})}function resizeIFrame(n,t,i){lazyInit(t,i);let u=$(n).parents("blockquote").length,r=maxWidth-u*quoteWidthBleed,e=maxHeight-u*quoteHeightBleed;$(n).attr({width:roundToNextEvenNumber(r),height:Math.max(roundToNextEvenNumber(e/1.8),roundToNextEvenNumber(r*9/16))});let f=$(n).attr("src");f.indexOf("imgur")!==-1&&$(n).attr("src",f+"?w="+r)}function lazyInit(n,t){quoteWidthBleed=quoteWidthBleed||$(".PostQuote").outerWidth(!0)-$(".PostQuote").width()||42;quoteHeightBleed=quoteHeightBleed||$(".PostQuote").outerHeight(!0)-$(".PostQuote").height()||62;maxWidth=maxWidth||n||roundToNextEvenNumber($(".FlexRow").width()-($(".Summary").is(":visible")?$(".Summary").outerWidth()*1.1:2));maxHeight=maxHeight||t||roundToNextEvenNumber($(window).innerHeight()-15)}function expandCollapsedMenu(n,t,i=false){let r=$("#"+n),u=$("#"+t);if(r.is(":visible"))r.hide("fast",function(){});else{let n=u.offset().top+u.height()+10;if(i){let t=u.offset().left;r.css({left:t+"px",top:n+"px"})}else{let t=$(window).innerWidth()-u.offset().left-u.outerWidth();r.css({right:t+"px",top:n+"px"})}r.show("fast",function(){})}}function showElement(n,t,i,r=false){let u=$("#"+n);t||(t=function(){});i||(i=function(){});u.is(":visible")?u.hide("fast",t):(r&&(u.height(roundToNextEvenNumber(u.height())),u.width(roundToNextEvenNumber(u.width()))),u.show("fast",i))}function writeDate(n,t){let i=new Date(n);t||(t=defaultDateFormat);document.write(i.format(t))}function roundToNextEvenNumber(n){return n=Math.round(n),n%2==1&&(n=Math.round(n/2)*2),n}function showForumTree(n){showElement("forumTree",null,()=>{$("html, body").scrollTop($(n).offset().top-$("#topBanner").outerHeight()-10),$("#treeContainer").scrollTop($(".selectedTreeNode").offset().top-$("#treeContainer").offset().top-50)})}function toggleHeaderLinks(n,t){let r=$("#"+t),f=$("#"+n),u=$("#"+n+"Button"),i=$("#"+t+"Button");r.length&&r.is(":visible")&&!f.is(":visible")&&showElement(t,function(){i.css("font-weight","normal")},null);showElement(n,function(){i.length&&u.css("font-weight","normal")},function(){i.length&&u.css("font-weight","bold")})}function selectAllCheckboxes(n=null){let t=n?$(`#${n}`).find("input[type=checkbox]"):$("input[type=checkbox]");t.prop("checked",!t.prop("checked"))}function formatString(n,...t){if(!n)return"";if(t===undefined||t.length==0)return n;for(i=0;i<t.length;i++)n=n.replace("{"+i+"}",t[i]);return n}function getDayNames(n){let r=[],t=new Date(Date.UTC(2021,0,10,0,0,0));for(i=0;i<7;i++,t.setDate(t.getDate()+1))r.push(t.toLocaleString(n,{weekday:"long"}));return r}function getMonthNames(n){let r=[],t=new Date(Date.UTC(2021,0,1,0,0,0));for(i=0;i<12;i++,t.setMonth(t.getMonth()+1))r.push(t.toLocaleString(n,{month:"long"}));return r}function expandSection(n,t){showElement(n,()=>{$("#"+t).html("&#x1F53D;")},()=>{$("#"+t).html("&#x1F53C;")})}function openTab(n,t){for(var r,u=document.getElementsByClassName("tabcontent"),i=0;i<u.length;i++)u[i].style.display="none";for(r=document.getElementsByClassName("tablinks"),i=0;i<r.length;i++)r[i].className=r[i].className.replace(" active","");document.getElementById(t).style.display="block";n.currentTarget.className+=" active"}String.prototype.replaceAt=function(n,t){return this.substr(0,n)+t+this.substr(n+t.length)};Date.prototype.format=function(n,t=dayNames,i=monthNames){var f=/\W+/,r=this,u;this.Date=function(n){var t=n.split(f);return t.forEach(function(t){typeof u[t]=="function"&&(n=n.replace(new RegExp("\\b"+t+"\\b"),u[t]()))}),n};u={d:function(){return r.getDate()},dd:function(){return _pad(r.getDate(),2)},ddd:function(){return t[r.getDay()].slice(0,3)},dddd:function(){return t[r.getDay()]},f:function(){return parseInt(r.getMilliseconds()/100)},ff:function(){return parseInt(r.getMilliseconds()/10)},fff:function(){return r.getMilliseconds()},F:function(){return r.getMilliseconds()/100>0?parseInt(r.getMilliseconds()/100):""},FF:function(){return r.getMilliseconds()/10>0?parseInt(r.getMilliseconds()/10):""},FFF:function(){return r.getMilliseconds()>0?r.getMilliseconds():""},h:function(){return r.getHours()%12||12},hh:function(){return _pad(r.getHours()%12||12,2)},H:function(){return r.getHours()},HH:function(){return _pad(r.getHours(),2)},m:function(){return r.getMinutes()()},mm:function(){return _pad(r.getMinutes(),2)},M:function(){return r.getMonth()+1},MM:function(){return _pad(r.getMonth()+1,2)},MMM:function(){return i[r.getMonth()].slice(0,3)},MMMM:function(){return i[r.getMonth()]},s:function(){return r.getSeconds()},ss:function(){return _pad(r.getSeconds(),2)},t:function(){return r.getHours()>=12?"P":"A"},tt:function(){return r.getHours()>=12?"PM":"AM"},y:function(){return Number(r.getFullYear().toString().substr(2,2))},yy:function(){return _pad(r.getFullYear().toString().substr(2,2),2)},yyy:function(){var n=Number(r.getFullYear().toString().substr(1,2));return n>100?n:r.getFullYear()},yyyy:function(){return r.getFullYear()},yyyyy:function(){return _pad(r.getFullYear(),5)},z:function(){return parseInt(r.getTimezoneOffset()/60)},zz:function(){var n=parseInt(r.getTimezoneOffset()/60);return n<0&&(n="-"+_pad(Math.abs(n),2)),n},zzz:function(){var n=parseInt(r.getTimezoneOffset()/60),t=r.getTimezoneOffset()-60*n,i=_pad(n,2)+":"+_pad(Math.abs(t),2);return n<0&&(i="-"+_pad(Math.abs(n),2)+":"+_pad(Math.abs(t),2)),i},st:function(){var n=u.d();return n<4|n>20&&["st","nd","rd"][n%10-1]||"th"},e:function(n){throw"ERROR: Not supported method ["+n+"]";}};_pad=function(n,t){return(n=n+"").length<t?new Array(++t-n.length).join("0")+n:n};try{return this.Date(n)}catch(e){return this.Date("dd.MM.yyyy HH:mm")}};class Posting{constructor(n,t,i,r,u,f,e){this.form_name="postform";this.text_name="message";this.bbcode=[];this.bbtags=n;this.theSelection=!1;this.baseHeight=0;this.hasConfirmation=!1;this.isAdmin=r;this.isEditAction=u;this.userDateFormat=f;this.imgSizeLimit=t;this.imgCountLimit=i;this.baseUrl=e}initInsertions(){var n=document.forms[this.form_name]?document:opener.document}bbstyle(n){this.bbfontstyle(this.bbtags[n].openTag,this.bbtags[n].closeTag)}bbfontstyle(n,t){var i,f,r,u;if(this.theSelection=!1,i=document.forms[this.form_name].elements[this.text_name],i.focus(),document.forms[this.form_name].elements[this.text_name].selectionEnd&&document.forms[this.form_name].elements[this.text_name].selectionEnd-document.forms[this.form_name].elements[this.text_name].selectionStart>0){this.mozWrap(document.forms[this.form_name].elements[this.text_name],n,t);document.forms[this.form_name].elements[this.text_name].focus();this.theSelection="";return}f=this.getCaretPosition(i).start;r=f+n.length;this.insert_text(n+t);isNaN(i.selectionStart)?document.selection&&(u=i.createTextRange(),u.move("character",r),u.select(),this.storeCaret(i)):(i.selectionStart=r,i.selectionEnd=r);i.focus();return}insert_text(n,t,i){var r,f,e,u;r=i?opener.document.forms[this.form_name].elements[this.text_name]:document.forms[this.form_name].elements[this.text_name];t&&(n=" "+n+" ");isNaN(r.selectionStart)?r.createTextRange&&r.caretPos?(this.baseHeight!=r.caretPos.boundingHeight&&(r.focus(),this.storeCaret(r)),u=r.caretPos,u.text=u.text.charAt(u.text.length-1)==" "?u.text+n+" ":u.text+n):r.value=r.value+n:(f=r.selectionStart,e=r.selectionEnd,this.mozWrap(r,n,""),r.selectionStart=f+n.length,r.selectionEnd=e+n.length);i||r.focus()}attach_inline(n,t){this.insert_text("[attachment="+n+"]"+t+"[/attachment]",!1,!1)}getCaretPosition(n){var t=new CaretPosition,u,i,r;if(n.selectionStart||n.selectionStart==0)t.start=n.selectionStart,t.end=n.selectionEnd;else if(document.selection){for(u=document.selection.createRange(),i=document.body.createTextRange(),i.moveToElementText(n),r=0;i.compareEndPoints("StartToStart",u)<0;r++)i.moveStart("character",1);n.sel_start=r;t.start=n.sel_start;t.end=n.sel_start}return t}addquote(n,t,i){this.theSelection="";window.getSelection?this.theSelection=window.getSelection().toString():document.getSelection?this.theSelection=document.getSelection():document.selection&&(this.theSelection=document.selection.createRange().text);(this.theSelection==""||typeof this.theSelection=="undefined"||this.theSelection==null)&&(this.theSelection=n);this.theSelection&&this.insert_text(`[quote="${t}",${i}]
${this.theSelection}
[/quote]
`);return}mozWrap(n,t,i){var u=n.textLength,f=n.selectionStart,r=n.selectionEnd,e=n.scrollTop;(r==1||r==2)&&(r=u);var o=n.value.substring(0,f),s=n.value.substring(f,r),h=n.value.substring(r,u);n.value=o+t+s+i+h;n.selectionStart=r+t.length+i.length;n.selectionEnd=n.selectionStart;n.focus();n.scrollTop=e;return}storeCaret(n){n.createTextRange&&(n.caretPos=document.selection.createRange().duplicate())}change_palette(){showElement("colour_palette",function(){$("#bbpalette").val(dictionary.Posting.FONT_COLOR)},function(){$("#bbpalette").val(dictionary.Posting.HIDE_FONT_COLOR)})}show_hidden_formatters(){showElement("controls",function(){$(".PostingControlsButton").text(dictionary.Posting.FORMATTING_OPTIONS)},function(){$(".PostingControlsButton").text(dictionary.Posting.HIDE_FORMATTING_OPTIONS)})}show_hidden_smilies(){showElement("hiddenSmilies",function(){$("#showHiddenSmiliesButton").text(dictionary.Posting.SHOW_MORE)},function(){$("#hiddenSmilies").find("img").each((n,t)=>{resizeImage(t,$("#hiddenSmilies").parent()[0].offsetWidth,$("#hiddenSmilies").parent()[0].offsetHeight)});$("#showHiddenSmiliesButton").text(dictionary.Posting.SHOW_LESS)},!1)}censor(){var n=document.getElementById("message"),r,u,i,f,e,t,o;if(n){if(n.value=n.value.replace(/postimage/gi,"*****"),n.value=n.value.replace(/postimg/gi,"*****"),n.value=n.value.replace(/photobucket/gi,"*****"),n.value=n.value.replace(/imageshack/gi,"*****"),r=n.value.split("[img]").length-1,r>this.imgCountLimit&&!this.isAdmin)return alert(formatString(dictionary.Posting.TOO_MANY_IMAGES_ERROR_FORMAT,r,this.imgCountLimit)),!1;if(u=n.value.match(/\[img\](.*?)\[\/img\]/g),!u)return!0;for(i=u.map(n=>n.replace(/\[\/?img\]/g,"")),$("#imgcheckstatus").toggle(),f=!0,e=[],t=0;t<i.length;t++)($("#imgcheckstatus").html(formatString(dictionary.Posting.CHECKING_IMAGES_FORMAT,Math.round(t*100/i.length))),i[t].indexOf(this.baseUrl)==-1)&&(o=$.ajax({type:"GET","async":!1,url:i[t],success:n=>{n.length/1048576>this.imgSizeLimit&&!this.isAdmin&&(f=!1,e.push(i[t]))},error:(n,t,i)=>{console.log(t,i)}}));return f||this.isAdmin?($("#imgcheckstatus").toggle(),!0):($("#imgcheckstatus").toggle(),alert(formatString(dictionary.Posting.IMAGES_TOO_BIG_ERROR_FORMAT,this.imgSizeLimit,e.join("\n"))),!1)}return!0}showExpirationDate(n){var i=document.getElementById("pollExpirationHelper"),t;if(n==0){i.innerText=dictionary.Posting.POLL_NEVER_EXPIRES;return}t=new Date;t.setSeconds(t.getSeconds()+n*86400);i.innerText=formatString(dictionary.Posting.POLL_EXPIRES_FORMAT,t.format(this.userDateFormat))}confirmPollChange(n){return!this.hasConfirmation&&!n.value?(this.hasConfirmation=!0,!0):this.isEditAction&&!this.hasConfirmation&&n.value&&confirm(dictionary.Posting.CONFIRM_POLL_OPTIONS_CHANGE)?(this.hasConfirmation=!0,!0):this.hasConfirmation}toggleAttach(){$("#pollPanel").is(":visible")&&showElement("pollPanel");$("#emojiPanel").is(":visible")&&showElement("emojiPanel");showElement("attachPanel")}togglePoll(){$("#attachPanel").is(":visible")&&showElement("attachPanel");$("#emojiPanel").is(":visible")&&showElement("emojiPanel");showElement("pollPanel")}toggleEmoji(){$("#attachPanel").is(":visible")&&showElement("attachPanel");$("#pollPanel").is(":visible")&&showElement("pollPanel");showElement("emojiPanel")}submitAttachments(){$("#submitAttachmentsButton").trigger("click");$("#fileUploadStatus").text(dictionary.Posting.LOADING_FILES)}}class CaretPosition{constructor(){this.start=null;this.end=null}}var maxWidth,maxHeight,quoteWidthBleed,quoteHeightBleed;class ViewTopic{constructor(n,t,i){this.postId=n;this.scrollToModPanel=t;this.otherReportReasonId=i}onLoad(){if(this.postId!=-1){let n=$("#"+this.postId),t=n.offset().top;window.scrollTo(0,t-20)}this.scrollToModPanel&&document.getElementById("moderatorForm").scrollIntoView()}switchPollPanels(n,t,i){let r=dictionary.ViewTopic.SHOW_RESULTS,u=dictionary.ViewTopic.DO_VOTE;showElement(n,function(){i.value=r},function(){i.value=u});showElement(t)}showMessageDetails(n,t,i,r,u){let f="<b>IP:<\/b> "+n+"<br/>";r>0&&(f=f+"<b>"+dictionary.ViewTopic.LAST_CHANGED+"<\/b> "+new Date(t).format(i)+", <b>"+dictionary.ViewTopic.CHANGED_BY+"<\/b> "+u+"<br /> <b>"+dictionary.ViewTopic.TOTAL_CHANGES+"<\/b> "+r+"<br/>");$("#postInfoContent").html(f);showElement("postInfo",null,null,!0)}showReportForm(n,t=null,i=null,r=null){$("#reportPostId").val(n);$("#reportReason").val(i?i:"-1");$("#reportId").val(t);$("#reportDetails").val(r);$("#reportValidation").hide();showElement("report",null,null,!0)}validateReportForm(){let t=$("#reportReason").val(),i=$("#reportDetails").val(),n=$("#reportValidation");return t?t==this.otherReportReasonId&&(!i||i.length<3)?(n.text(dictionary.ViewTopic.FILL_REPORT_DETAILS),n.show(),!1):!0:(n.text(dictionary.ViewTopic.CHOOSE_REPORT_REASON),n.show(),!1)}showReportViewer(n,t,i,r,u,f){$("#reportViewerReportPostId").val(n);$("#reportViewerReportReasonTitle").text(he.decode(i));$("#reportViewerReportReasonDescription").text(r);$("#reportViewerReportId").val(t);$("#reportViewerReportDetails").html(he.decode(u));$("#reportViewerReporter").text(he.decode(f));$("#reportViewerEditMessage").prop("checked",!1);$("#reportViewerDeleteMessage").prop("checked",!1);showElement("reportViewer",null,null,!0)}confirmDeleteReportedPost(){return $("#reportViewerDeleteMessage").is(":checked")?confirm(dictionary.ViewTopic.CONFIRM_DELETE_REPORTED_MESSAGE):!0}}class Moderator{constructor(n,t,i){this.moveTopic=n;this.moveSelectedPosts=t;this.splitSelectedPosts=i}showTopicExtraInput(n){$(n).val()==this.moveTopic&&($("#extraInputPostForum").hide("fast"),$("#extraInputPostTopic").hide("fast"),$("#extraInputTopic").show("fast"));$("#topicAction").val($(n).val());$("#showTopicSelector").val("false")}showPostExtraInput(n){$(n).val()==this.moveSelectedPosts?($("#extraInputPostForum").hide("fast"),$("#extraInputTopic").hide("fast"),$("#extraInputPostTopic").show("fast"),$("#showTopicSelector").val("true")):$(n).val()==this.splitSelectedPosts&&($("#extraInputTopic").hide("fast"),$("#extraInputPostTopic").hide("fast"),$("#extraInputPostForum").show("fast"),$("#showTopicSelector").val("false"));$("#postAction").val($(n).val())}appendToStringList(n,t){let r=$(`#${t}`),i=r.val().split(","),u=$(n).val();if(n.checked)i.push(u.toString());else{let n=i.indexOf(postId.toString());n>-1&&i.splice(n,1)}r.val(i.join(","))}confirmAction(n){let t=$(n).val();return t.startsWith("Delete")?confirm(dictionary.ViewTopic.RECEIVED_COMMAND+' "'+$(n).find(":selected").text()+'". '+dictionary.ViewTopic.CONTINUE):!0}deletePost(n,t){$("input[name='PostIdsForModerator']").each(function(t,i){$(i).val()==n?$(i).attr("checked",""):$(i).removeAttr("checked")});$("#PostAction").val("DeleteSelectedPosts");this.confirmAction("#PostAction")&&(t&&$("#closestPostId").val(t),$("#moderatorForm").submit())}duplicatePost(n){confirm(dictionary.ViewTopic.RECEIVED_COMMAND+' "'+dictionary.Moderator.DUPLICATE_POST+'". '+dictionary.ViewTopic.CONTINUE)&&($("#PostIdForDuplication").val(n),$("#moderatorDuplicateMessageForm").submit())}}